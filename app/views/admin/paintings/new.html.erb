<%= link_to 'Home', root_path %>/
<%= link_to 'Admin', admin_path %>/
<%= link_to 'Galleries', admin_galleries_path %>/
<%= link_to 'Edition', edit_admin_gallery_path(@gallery.id) %>

<%= render '/shared/flash', flash: flash %>

<h2><%= @gallery.name %></h1>

<%= form_for [:admin, @gallery, @painting], :remote => true do |f| %>

	<%= render 'shared/error_messages', object: f.object %>

	<p id="notice"><%= notice %></p>

		Téléverser des images:
		<input id="fileupload" type="file" name="painting[image]" multiple>
		<div class="progress">
		<span class="progress-val">0%</span>
    <span class="progress-bar"><span class="progress-in"></span></span>
		</div>
		<script>
		
		$(function () {
		    $('#fileupload').fileupload({
		    		acceptFileTypes: /(\.|\/)(gif|jpe?g|png)$/i,
		        dataType: 'json',
		        url: '<%= admin_gallery_paintings_path(@gallery.id) %>',
		        chunkdone: function (e, data) {
		            $.each(data.result, function (index, file) { 
		               $('<img style="float:left" src="'+file.thumbnail_url+'">').appendTo('#thumbs');
		            });
		            $('.progress .progress-val').text('100% chargement terminé');
		        },
		        progressall: function (e, data) {
				        var progress = parseInt(data.loaded / data.total * 100, 10);
				        $('.progress .progress-in').css(
				            'width',
				            progress + '%'
				        );
				        $('.progress .progress-val').text(progress + '%');
				    },
				    fail: function (e, data) {
				    	$('.progress .progress-val').text('Téleversement échoué! :/');
				    }
				});
		});
		</script>
	
		<div id="thumbs" class="cf">
	<!-- json-ajax response here, see fileupload script above, .appendTo css id:"thumbs"-->
		</div>

<div class="clear">
</div>

<% end %>